# 資料匯出/匯入功能使用指南

## 功能概覽

專案管理系統提供完整的資料匯出和匯入功能，讓您能夠：
- 備份所有系統資料
- 在不同環境間遷移資料
- 匯出特定類型的資料進行分析
- 從備份檔案恢復資料

## 存取方式

### 方式一：透過資料管理頁面
1. 進入「資料管理」頁面
2. 點選右上角的「匯出/匯入資料」按鈕

### 方式二：透過主導航工具列
1. 在任何頁面的頂部工具列
2. 點選「匯出/匯入」圖示按鈕 (import_export)

## 匯出功能

### 完整資料匯出 (JSON 格式)
- **用途**: 備份所有系統資料
- **包含內容**:
  - 人員資料 (姓名、員編、部門等)
  - 系統資料 (系統名稱、代碼、描述等)
  - 專案資料 (專案、任務、進度等)
- **檔案格式**: JSON
- **檔案命名**: `project-data-export-YYYY-MM-DD.json`

### 分別匯出 (CSV 格式)
適合用於資料分析或與其他系統整合：

#### 人員資料 CSV
- 包含欄位: ID、姓名、員編、Email、部門名稱、部門代號、科組名稱、科組代號
- 檔案命名: `members-YYYY-MM-DD.csv`

#### 系統資料 CSV
- 包含欄位: ID、系統名稱、系統代碼、描述、負責人、建立日期
- 檔案命名: `systems-YYYY-MM-DD.csv`

#### 專案任務資料 CSV
- 包含欄位: ID、負責人、專案、系統、任務、複雜度、優先度、狀態、開始日期、結束日期、實際結束日期
- 檔案命名: `tasks-YYYY-MM-DD.csv`

## 匯入功能

### 支援格式
- **JSON 格式**: 完整資料匯入
- 必須是由本系統匯出的 JSON 檔案

### 匯入流程
1. 點選「匯入資料」分頁
2. 閱讀注意事項（匯入會覆蓋現有資料）
3. 點選「選擇檔案」按鈕
4. 選擇要匯入的 JSON 檔案
5. 確認檔案資訊無誤後，點選「開始匯入」
6. 系統會自動驗證檔案格式
7. 匯入成功後，頁面會自動重新載入

### 注意事項
⚠️ **重要警告**:
- 匯入資料會完全覆蓋現有的所有資料
- 建議在匯入前先進行完整資料匯出作為備份
- 匯入過程中請勿關閉瀏覽器或離開頁面
- 匯入完成後系統會自動重新載入頁面

## 資料格式說明

### JSON 匯出檔案結構
```json
{
  "version": "1.0.0",
  "exportDate": "2024-01-01T00:00:00.000Z",
  "members": [
    {
      "id": 1,
      "name": "王工程師",
      "employeeId": "E001",
      "email": "wang@company.com",
      "department": "開發部",
      "departmentCode": "DEV",
      "section": "前端開發科",
      "sectionCode": "FE"
    }
  ],
  "systems": [
    {
      "id": 1,
      "name": "專案管理系統",
      "code": "PMS",
      "description": "專案進度管理系統",
      "owner": "系統管理員",
      "createdAt": "2024-01-01"
    }
  ],
  "projectData": {
    "projectTableData": [...],
    "memberTableData": [...]
  }
}
```

## 最佳實務建議

### 定期備份
- 建議每週進行一次完整資料匯出
- 重要專案里程碑前進行備份
- 系統更新或維護前必須備份

### 檔案管理
- 使用有意義的檔案命名規則
- 將備份檔案存放在安全的位置
- 定期清理過期的備份檔案

### 匯入前檢查
- 確認匯入檔案的來源和完整性
- 檢查匯入檔案的日期和版本
- 在測試環境先進行匯入測試

## 故障排除

### 常見問題

**Q: 匯出時顯示「資料匯出失敗」**
A: 檢查瀏覽器是否允許下載檔案，或嘗試重新整理頁面後再次匯出

**Q: 匯入時顯示「檔案格式不正確」**
A: 確認選擇的是由本系統匯出的 JSON 檔案，且檔案未被修改

**Q: 匯入後資料不完整**
A: 檢查匯入檔案是否完整，或聯繫系統管理員

**Q: CSV 檔案中文顯示亂碼**
A: 使用支援 UTF-8 編碼的軟體開啟 CSV 檔案（如 Excel、Google Sheets）

### 技術支援
如遇到其他問題，請聯繫系統管理員或技術支援團隊。