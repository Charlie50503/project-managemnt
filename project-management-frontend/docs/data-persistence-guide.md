# 資料持久化指南

## 概述

本系統採用純 JSON 檔案資料持久化方案，所有資料都直接從 `src/assets/data/` 目錄中的 JSON 檔案載入。

## 資料流程

### 1. 資料載入
- 系統啟動時直接從 `src/assets/data/` 載入 JSON 檔案
- 如果檔案載入失敗，使用空陣列作為預設值
- 所有資料變更只存在於記憶體中（BehaviorSubject）

### 2. 資料變更
- 所有 CRUD 操作只更新記憶體中的資料
- 資料變更會立即反映在使用者介面上
- **重要**: 資料變更不會自動儲存到檔案中

## 檔案結構

```
src/assets/data/
├── members.json      # 人員資料
├── systems.json      # 系統資料
└── project-data.json # 案件和任務資料
```

## 匯出功能

### 1. 完整資料匯出
- 位置：資料管理頁面 → 匯出/匯入資料按鈕
- 功能：匯出所有資料為單一 JSON 檔案
- 用途：備份、資料遷移、跨環境同步

### 2. 個別檔案匯出
- 位置：資料管理頁面 → 各分頁的「匯出檔案」按鈕
- 功能：匯出特定類型的資料為 JSON 檔案
- 用途：更新 assets 檔案、部分資料備份

## 開發者工作流程

### 更新 Assets 檔案
1. 在系統中新增/修改資料
2. 到資料管理頁面點擊對應的「匯出檔案」按鈕
3. 將下載的 JSON 檔案替換 `src/assets/data/` 中的對應檔案
4. 提交程式碼變更

### 資料遷移
1. 在來源環境匯出個別檔案
2. 手動替換目標環境的 `src/assets/data/` 檔案
3. 重新編譯並部署應用程式

## 技術實現

### Service 層級
- **MemberCrudService**: 管理人員資料
- **SystemCrudService**: 管理系統資料  
- **ProjectCrudService**: 管理案件和任務資料
- **DataExportImportService**: 處理匯出匯入功能

### 資料同步
- 使用 RxJS BehaviorSubject 確保資料即時同步
- 所有組件都會自動接收資料變更通知
- 無需手動刷新頁面

## 注意事項

### 資料持久性
- **重要**: 資料變更只存在於瀏覽器會話中
- 重新載入頁面會重置所有變更
- 必須使用匯出功能來保存變更到檔案

### 開發環境
- 開發時資料變更不會自動更新 assets 檔案
- 需要手動匯出並替換檔案
- 建議在版本控制中追蹤 assets 檔案變更

### 生產環境
- 確保 assets 檔案包含正確的初始資料
- 考慮實施定期備份機制
- 資料變更需要重新編譯和部署

## 故障排除

### 資料載入失敗
1. 確認 assets 檔案是否存在且格式正確
2. 查看瀏覽器控制台是否有錯誤訊息
3. 檢查 HTTP 請求是否成功（網路標籤）

### 匯出失敗
1. 確認瀏覽器允許檔案下載
2. 檢查是否有足夠的磁碟空間
3. 驗證資料格式是否正確

### 資料變更遺失
1. 記住資料變更只存在於記憶體中
2. 使用匯出功能保存變更
3. 手動替換 assets 檔案並重新編譯